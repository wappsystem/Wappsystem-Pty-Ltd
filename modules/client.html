<section>
      VmInclude:__BASE__/vmiis/Common-Code/frame/excel.html
</section>
<script>
    function F__ID(){
        //-------------------------------------
        var fields="Client_Name,Address,Suburb,Postcode,State,Contact_Name,Telephone,Mobilephone,Fax,Email,Web,Additional_Information";
        fields+=",Submit Date|DateTime,Submitted by|Author";
        //-------------------------------------
        VmInclude:__BASE__/vmiis/Common-Code/frame/excel.js
        //-------------------------------------
        var before_change=function(changes,source){
            process_postcode(changes,source,'Suburb',2,'Postcode',3,'State',4);
        };
        //-------------------------------------
        columns[2]={data:'Suburb',type: 'autocomplete',trimDropdown:false, source:function(query, process){
            req_data={cmd:'suburb',query:query,count:'10'}
            $VmAPI.request({data:req_data,callback:function(res){
                process($.parseJSON(res.ret));
            }})
        }};
        //-------------------------------------
        columns[3]={data:'Postcode',type: 'autocomplete',trimDropdown:false, source:function(query, process){
            req_data={cmd:'postcode',query:query,count:'10'}
            $VmAPI.request({data:req_data,callback:function(res){
                process($.parseJSON(res.ret));
            }})
        }};
        //-------------------------------------
        $('#D__ID').on('load',function(){
              grid_data();
        })
        //-------------------------------------
    }
</script>
<style>
    VmInclude:__BASE__/vmiis/Common-Code/toolbar/toolbar_for_excel.css
    #D__ID{
        font-size:14px;
        font-family: Helvetica, Arial, sans-serif;
    }
</style>
