<!DOCTYPE html><html><head id=main_head>
      <link rel="stylesheet" href="https://ajax.aspnetcdn.com/ajax/jquery.ui/1.11.4/themes/redmond/jquery-ui.css" />
      <link rel="stylesheet" media="screen" href="https://cbs.wappsystem.com/system/third/handsontable.full.min.css">
      <script src="https://ajax.aspnetcdn.com/ajax/jquery/jquery-2.1.4.min.js"></script>
      <style> *{ margin:0; }	 html,body { height:100%;} </style>
</head><body></body></html>
<script>
$vm={}; $VmAPI={};
$(document).ready(function(){
      //--------------------------------------------------------
      $vm.first_module              ='https://raw.githubusercontent.com/wappsystem/Wappsystem-Pty-Ltd/master/modules/main_layout.html';
      $vm.first_module_src          ='https://github.com/wappsystem/Wappsystem-Pty-Ltd/blob/master/modules/main_layout.html';
	$vm.server		            ="development";
	$vm.debug		            =true;
	$vm.debug_message	            =true;
	$VmAPI.api_base	            ="https://cbs.wappsystem.com/dev/";
	//--------------------------------------------------------
      g_server          =$vm.server;						//for old vm.js
	g_vm_api_url	="https://cbs.wappsystem.com/dev/api.aspx";	//for old vm.js
	//--------------------------------------------------------
	var start=function(){
		var url=$vm.url('https://raw.githubusercontent.com/wappsystem/Wappsystem-Pty-Ltd/master/version.html?_=')+new Date().getTime();
		if($vm.debug_message===true) console.log('load module from '+url);
		$.get(url,function(new_ver){	$vm.version=new_ver;load_vmapi();},'text')
	}
	//--------------------------------------------------------
	var load_vmapi   =function(){ load_js($vm.url('https://raw.githubusercontent.com/vmiis/VmAPI/master/distribution/vmapi.min.js?_'+$vm.version),load_vm);	}
	var load_vm      =function(){ load_js($vm.url('https://raw.githubusercontent.com/vmiis/VmFramework/master/distribution/vmframework.min.js?_'+$vm.version),init);}
	var init         =function(){ $vm.init({callback:function(){ $vm.load_first_module(); last();  }});	}
	//--------------------------------------------------------
	var load_js=function(url,next){
		var ver=localStorage.getItem(url+"_ver");
		var txt=localStorage.getItem(url+"_txt");
		//------------------------------------------
		if(ver!=$vm.version || txt===null || $vm.debug===true){
                  if($vm.debug_message===true) console.log('load module from '+url);
                  $.get(url,function(data){
			      localStorage.setItem(url+"_txt",data);
			      localStorage.setItem(url+"_ver",$vm.version);
			      $('#main_head').append('<scr'+'ipt>'+data+'</scr'+'ipt>');
                        next();
		      },'text');
            }
		else{ $('#main_head').append('<scr'+'ipt>'+txt+'</scr'+'ipt>'); next(); }
            //------------------------------------------
	}
	//--------------------------------------------------------
	$vm.url=function(text){
		var re1=new RegExp('https://raw.githubusercontent.com', 'g'); 	text=text.replace(re1,window.location.protocol+'//'+window.location.host);
		var re2=new RegExp('/master/', 'g');					text=text.replace(re2,'/');
		var re3=new RegExp('/blob/', 'g');					      text=text.replace(re3,'/blob/master/');
		return text;
	}
	//--------------------------------------------------------
	start();
	//--------------------------------------------------------
      var last=function(){
            setTimeout(function () {
                  $.ajaxSetup({ cache: true });
                  $.getScript('https://ajax.aspnetcdn.com/ajax/jquery.ui/1.11.4/jquery-ui.min.js');
                  $.getScript('https://ajax.aspnetcdn.com/ajax/jquery.validate/1.14.0/jquery.validate.min.js');
                  $.getScript('https://sdk.amazonaws.com/js/aws-sdk-2.1.34.min.js');
                  $.getScript('https://cbs.wappsystem.com/system/third/handsontable.full.min.js');
                  $.getScript('https://cbs.wappsystem.com/dev/vm.js?v=20160108');
                  $.getScript('https://www.google.com/jsapi',function(){
                        google.load('visualization', '1', {'packages':['corechart'],callback:function(){} } );
                  });
            }, 100);

      }
      //--------------------------------------------------------
});
</script>
